从package安装
1.CentOS
1)添加remi源
[root@vultr ~]# yum install https://mirrors.tuna.tsinghua.edu.cn/remi/enterprise/remi-release-7.rpm
** 源镜像列表: https://rpms.remirepo.net/

2)安装php8.1
[root@vultr ~]# yum install yum-utils

[root@vultr ~]# yum-config-manager --enable remi-php81

[root@vultr ~]# yum install php php-devel php-fpm php-mysqlnd

3)修改php-fpm process的owner/group
[root@vultr ~]# vi /etc/php-fpm.d/www.conf
user = nginx
group = nginx

4)启动php-fpm
[root@vultr ~]# systemctl start php-fpm

[root@vultr ~]# systemctl enable php-fpm

5)添加nginx对php支持
[root@vultr ~]# cp /etc/nginx/nginx.conf /etc/nginx/nginx.conf.bak

[root@vultr ~]# vi /etc/nginx/nginx.conf
    server{
        location / {
            root /usr/share/nginx/html;
            index index.php index.html index.htm;
        }
        location ~ \.php$ {
            root /usr/share/nginx/html;
            fastcgi_pass 127.0.0.1:9000;
            fastcgi_index index.php;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            include fastcgi_params;
        }
    }

6)重启web server(nginx)
[root@vultr nginx]# systemctl restart nginx

7)验证安装结果
[root@vultr ~]# vi /usr/share/nginx/html/index.php
<?php
   phpinfo();
?>

**浏览器栏输入<server_ip>/index.php, 测试是否出现php欢迎界面



从source code编译安装
1)下载php
[root@vultr ~]# curl -O https://www.php.net/distributions/php-8.1.8.tar.gz

2)必需环境
前提软件: libxml2/sqlite3/zlib/bzip2/libcurl/gcc/make/web server(nginx/apacha等)
[root@vultr ~]# yum install libxml2-devel sqlite-devel zlib-devel bzip2-devel libcurl-devel gcc make

3)编译安装
[root@vultr ~]# tar -zxvf php-8.1.8.tar.gz -C /tmp

[root@vultr ~]# cd /tmp/php-8.1.8

[root@vultr ~]# ./configure --enable-fpm --with-mysqli --with-pdo-mysql --with-zlib --with-bz2 --with-curl

[root@vultr ~]# make

[root@vultr ~]# sudo make install

4)配置文件
[root@vultr ~]# cp php.ini-development /usr/local/lib/php.ini

[root@vultr ~]# cp /usr/local/etc/php-fpm.d/www.conf.default /usr/local/etc/php-fpm.d/www.conf

[root@vultr ~]# cp /usr/local/etc/php-fpm.conf.default /usr/local/etc/php-fpm.conf

5)php.in配置
[root@vultr ~]# vi /usr/local/lib/php.ini
cgi.fix_pathinfo=0
mysqli.default_socket = /var/lib/mysql/mysql.sock
pdo_mysql.default_socket=/var/lib/mysql/mysql.sock

6)修改php-fpm.conf包含的配置文件
[root@vultr ~]# vi /usr/local/etc/php-fpm.conf
143gg
include=etc/php-fpm.d/*conf

7)修改php-fpm的执行者/群组为web server执行者, 并启动php-fpm
[root@vultr ~]# vi /usr/local/etc/php-fpm.d/www.conf
user = nginx
group = nginx

[root@vultr ~]# php-fpm

8)配置nginx支持php, 并重启nginx
[root@vultr ~]# vi /etc/nginx/nginx.conf
    server{
        location / {
            root /usr/share/nginx/html;
            index index.php index.html index.htm;
        }
        location ~ \.php$ {
            root /usr/share/nginx/html;
            fastcgi_index index.php;
            fastcgi_pass 127.0.0.1:9000;
            include fastcgi_params;
            fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
        }
    }



[root@vultr ~]# systemctl restart nginx

9)创建测试文件
[root@vultr ~]# vi /usr/local/nginx/html/index.php
<?php
    phpinfo();
?>


最后编辑于: 2022-08-23
