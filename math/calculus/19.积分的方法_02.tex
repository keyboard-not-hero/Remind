\chapter{积分的方法 II}
1.三角恒等式\\
(1)形如$\sqrt{1\pm\cos(x)}$\\
例.\\
$\displaystyle\int_0^{\frac{\pi}{2}}\sqrt{1-\cos(2x)}\dif x$\\
推导原理:\\
将一个数与三角函数的运算, 转化为该三角函数半角的三角函数平方, 便于开根号\\
推导过程:\\
由$\cos(2x)=1-2\sin^2(x)$, 得:\\
$\displaystyle\int_0^{\frac{\pi}{2}}\sqrt{1-\cos(2x)}\dif x=\sqrt{2}\int_0^{\frac{\pi}{2}}|\sin(x)|\dif x$\\
由于$\sin(x)$在定义域区间$[0,\frac{\pi}{2}]$内为正, 所以:\\
$\displaystyle\int_0^{\frac{\pi}{2}}\sqrt{1-\cos(2x)}\dif x=-\sqrt{2}\cos(x)\Big{|}_0^{\frac{\pi}{2}}=0-(-\sqrt{2})=\sqrt{2}$\\

(2)形如$\sqrt{1-\sin^2(x)}/\sqrt{1+\tan^2(x)}$\\
例.\\
$\displaystyle\int_0^{\pi}\sqrt{1-\cos^2(x)}\dif x$\\
推导原理:\\
将根号下一个数字与三角函数平方的运算, 转化为该三角函数角的另一个三角函数的平方, 便于开根号\\
推导过程:\\
由$\sin^2(x)=1-\cos^2(x)$, 得:\\
$\displaystyle\int_0^{\pi}\sqrt{1-\cos^2(x)}\dif x=\int_0^{\pi}\sqrt{sin^2(x)}\dif x=\int_0^{\pi}|\sin(x)|\dif x$\\
由于$\sin(x)$在区间$[0,\pi]$内为正, 所以:\\
$\displaystyle\int_0^{\pi}\sqrt{1-\cos^2(x)}\dif x=\int_0^{\pi}\sin(x)\dif x=-\cos(x)\Big{|}_0^{\pi}=1-(-1)=2$\\

(3)形如$\displaystyle\frac{1}{\sec(x)-1}$\\
例.\\
$\displaystyle\int\frac{1}{\sec(x)-1}\dif x$\\
推导原理:\\
将分子分母同时乘以分母的共轭式\\
推导过程:\\
$\displaystyle\int\frac{1}{\sec(x)-1}\dif x=\int\frac{1}{\sec(x)-1}\times\frac{\sec(x)+1}{\sec(x)+1}\dif x=\int\frac{\sec(x)+1}{\sec^2(x)-1}\dif x$\\
\phantom{$\displaystyle\int\frac{1}{\sec(x)-1}\dif x$}$\displaystyle=\int\frac{\sec(x)}{\tan^2(x)}\dif x+\int\frac{1}{\tan^2(x)}\dif x=\int\frac{\cos(x)}{\sin^2(x)}\dif x+\int\frac{1}{\tan^2(x)}\dif x$\\
设$t=\sin(x)$, 则$\dif t=\cos(x)\dif x$, 得:\\
$\displaystyle\int\frac{\cos(x)}{\sin^2(x)}\dif x=\int\frac{1}{t^2}\dif t=-\frac{1}{t}+C=-\csc(x)+C$\\
由$\displaystyle\frac{\dif}{\dif x}\cot(x)=-\csc^2(x)$, 得:\\
$\displaystyle\int\frac{1}{\tan^2(x)}\dif x=\int\cot^2(x)\dif x=\int\csc^2(x)\dif x-\int\dif x=-\cot(x)-x+C$\\
$\therefore\displaystyle\int\frac{1}{\sec(x)-1}\dif x=-\csc(x)-\cot(x)-x+C$\\

(4)形如$\sin(\alpha)\cos(\beta)$\\
例.\\
$\displaystyle\int\sin(19x)\cos(3x)\dif x$\\
推导原理:\\
利用和/差角公式:
{\par\centering
    \framebox{$\sin(A+B)=\sin(A)\cos(B)+\cos(A)\sin(B)$}\\[2ex]
    \framebox{$\cos(A+B)=\cos(A)\cos(B)-\sin(A)\sin(B)$}\\[2ex]
    \framebox{$\sin(A-B)=\sin(A)\cos(B)-\cos(A)\sin(B)$}\\[2ex]
    \framebox{$\cos(A-B)=\cos(A)\cos(B)+\sin(A)\sin(B)$}
\par}\vspace{2ex}
可推断出:
{\par\centering
	\framebox{$\sin(A)\cos(B)=\dfrac{1}{2}(\sin(A+B)+\sin(A-B))$}\\[2ex]
	\framebox{$\cos(A)\cos(B)=\dfrac{1}{2}(\cos(A+B)+\cos(A-B))$}\\[2ex]
	\framebox{$\sin(A)\sin(B)=\dfrac{1}{2}(\cos(A-B)-\cos(A+B))$}\\[2ex]
\par}\newpage
推导过程:\\
$\displaystyle\therefore\int\sin(19x)\cos(3x)\dif x=\frac{1}{2}\int(\sin(19x+3x)+\sin(19x-3x))\dif x$\\
$\displaystyle\phantom{\therefore\int\sin(19x)\cos(3x)\dif x}=\frac{1}{2}\int(\sin(22x)+\sin(16x))\dif x$\\
$\displaystyle\phantom{\therefore\int\sin(19x)\cos(3x)\dif x}=\frac{1}{2}\left(-\frac{\cos(22x)}{22}-\frac{\cos(16x)}{16}\right)+C$\\
$\displaystyle\phantom{\therefore\int\sin(19x)\cos(3x)\dif x}=-\frac{\cos(22x)}{44}-\frac{\cos(16x)}{32}+C$\\[4ex]

2.关于三角函数的幂的积分\\
(1)$\sin$或$\cos$的幂\\
I、至少一个乘积项为奇次幂\\
例.\\
$\displaystyle\int\sin^7(x)\cos^4(x)\dif x$\\
解题思路:\\
将奇次幂分解为1次方和n-1次方, 并且将剩下的n-1偶次幂利用$\cos^2(x)+\sin^2(x)=1$进行转化\\
推导过程:\\
设$t=\cos(x)$, 则$\dif t=-\sin(x)\dif x$, 得:\\
\(\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\sin^7(x)\cos^4(x)\dif x & =-\int\sin^6(x)\cos^4(x)(-\sin(x)\dif x)\\
& =-\int(1-\cos^2(x))^3\cos^4(x)(-\sin(x)\dif x)\\
& =-\int(1-t^2)t^4\dif t\\
& =-\int(1-3t^2+3t^4-t^6)t^4\dif t\\
& =-\int(t^4-3t^6+3t^8-t^{10})\dif t\\
& =-\dfrac{1}{5}t^5+\dfrac{3}{7}t^7-\dfrac{1}{3}t^9+\dfrac{1}{11}t^{11}+C\\[1ex]
& =-\dfrac{1}{5}\cos^5(x)+\dfrac{3}{7}\cos^7(x)-\dfrac{1}{3}\cos^9(x)+\dfrac{1}{11}\cos^{11}(x)+C
\end{array}\)\\[2ex]

II、两个乘积项都为偶次幂\\
例.\\
$\displaystyle\int\cos^2(x)\sin^4(x)\dif x$\\
解题思路:\\
利用倍角公式降低幂次\\
推导过程:\\
\(\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\cos^2(x)\sin^4(x)\dif x & =\int\dfrac{1}{2}(1+\cos(2x))(\dfrac{1}{2}(1-\cos(2x)))^2\dif x\\[1ex]
& =\dfrac{1}{8}\int(1+\cos(2x))(1-\cos(2x))^2\dif x\\[1ex]
& =\dfrac{1}{8}\int(1-\cos(2x)-\cos^2(2x)+\cos^3(2x))\dif x\\[1ex]
& =\dfrac{1}{8}\int 1\dif x-\dfrac{1}{8}\int\cos(2x)\dif x-\dfrac{1}{8}\int\cos^2(2x)\dif x+\dfrac{1}{8}\int\cos^3(2x)\dif x\\[1ex]
& =\dfrac{1}{8}x-\dfrac{1}{16}\sin(2x)-\dfrac{1}{16}\int(1+\cos(4x))\dif x+\dfrac{1}{8}\int(1-\sin^2(2x))\cos(2x)\dif x\\[1ex]
& =\dfrac{1}{8}x-\dfrac{1}{16}\sin(2x)-\dfrac{1}{16}(x+\dfrac{\sin(4x)}{4})+\dfrac{1}{8}(\dfrac{\sin(2x)}{2}-\dfrac{\sin^3(2x)}{6})+C\\[1ex]
& =\dfrac{1}{16}x-\dfrac{1}{48}\sin^3(2x)-\dfrac{1}{64}\sin(4x)+C
\end{array}\)\\[2ex]

(2)$\tan$的幂($\cot$类似)\\
I、当幂为1\\
例.\\
$\displaystyle\int\tan(x)\dif x$\\
解题思路:\\
转化为$\dfrac{\sin(x)}{\cos(x)}$格式\\
推导过程:\\
假设$t=\cos(x)$,则$\dif t=-\sin(x)\dif x$\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\tan(x)\dif x & =\int\dfrac{\sin(x)}{\cos(x)}\dif x\\
& =-\int\dfrac{1}{t}\dif t\\
& =-\ln|t|+C\\
& =-\ln|\cos(x)|+C
\end{array}$\\[2ex]

II、当幂为2\\
例.\\
$\displaystyle\int\tan^2(x)\dif x$\\
解题思路:\\
将$\tan^2(x)$转化为$\sec^2(x)-1$\\
推导过程:\\
$\displaystyle\int\tan^2(x)\dif x=\int(\sec^2(x)-1)\dif x$\\
$\displaystyle\phantom{\int\tan^2(x)\dif x}=\int\sec^2(x)\dif x-\int 1\dif x$\\
$\displaystyle\phantom{\int\tan^2(x)\dif x}=\tan(x)-x+C$\\[2ex]

III、当幂大于等于3\\
例.\\
$\displaystyle\int\tan^6(x)\dif x$\\
解题思路:\\
首先, 从中提取一个$\tan^2(x)$变化为$\sec^2(x)-1$, 然后被积分部分分成两部分. 第一部分为关于$t=\tan^2(x)$的积分; 第二部分为$\tan(x)$的更低次幂, 继续循环当前操作
推导过程:\\
$\displaystyle\int\tan^6(x)\dif x=\int\tan^4(x)(\sec^2(x)-1)\dif x=\int\tan^4(x)\sec^2(x)\dif x-\int\tan^4(x)\dif x$\\
设$t=\tan(x)$, 则$\dif t=\sec^2(x)\dif x$, 得:\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\tan^4(x)\sec^2(x)\dif x & =\int t^4\dif t\\
& =\dfrac{1}{5}t^5+C\\[1ex]
& =\dfrac{1}{5}\tan^5(x)+C
\end{array}$\\[1ex]
设$t=\tan(x)$, 则$\dif t=\sec^2(x)\dif x$, 得:\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\tan^4(x)\dif x & =\int\tan^2(x)(\sec^2(x)-1)\dif x\\
& =\int\tan^2(x)\sec^2(x)\dif x-\int\tan^2(x)\dif x\\
& =\int\tan^2(x)\sec^2(x)\dif x-\int(\sec^2(x)-1)\dif x\\
& =\int\tan^2(x)\sec^2(x)\dif x-\int\sec^2(x)\dif x+\int 1\dif x\\
& =\int t^2\dif t-\int 1\dif t+\dif 1\dif x\\
& =\dfrac{1}{3}t^3-t+x+C\\[1ex]
& =\dfrac{1}{3}\tan^3(x)-\tan(x)+x+C
\end{array}$\\[1ex]
合并结果, 得:\\
$\displaystyle\int\tan^6(x)=\dfrac{1}{5}\tan^5(x)-\dfrac{1}{3}\tan^3(x)+\tan(x)-x+C$\\[4ex]

(3)$\sec$的特征($\csc$类似)\\
I、当幂等于1\\
例.\\
$\displaystyle\int\sec(x)\dif x$\\
解题思路:\\
分子与分母同时乘以$\sec(x)+\tan(x)$, 得到形如$\displaystyle\int\frac{f'(x)}{f(x)}\dif x$的结果\\
推导过程:\\
设$t=\sec(x)+\tan(x)$, 则$\dif t=\sec(x)\tan(x)+\sec^2(x)\dif x$, 得:\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\sec(x)\dif x & =\int\sec(x)\times\dfrac{\sec(x)+\tan(x)}{\sec(x)+\tan(x)}\dif x\\[1ex]
& =\int\dfrac{\sec^2(x)+\sec(x)\tan(x)}{\sec(x)+\tan(x)}\dif x\\[1ex]
& =\int\dfrac{1}{t}\dif t\\[1ex]
& =\ln|t|+C\\
& =\ln|\sec(x)+\tan(x)|+C
\end{array}$\\[2ex]

II、当幂等于2\\
例.\\
$\displaystyle\int\sec^2(x)\dif x$\\
解题思路:\\
$\displaystyle\int\sec^2(x)\dif x=\tan(x)+C$\\[2ex]

III、当幂大于等于3\\
例.\\
$\displaystyle\int\sec^6(x)\dif x$\\
解题思路:\\
提取出$\sec^2(x)$, 利用分部积分公式: $\displaystyle\int u\dif v=uv-\int v\dif u$\\
推导过程:\\
$\displaystyle\int\sec^6(x)\dif x=\int\sec^4(x)\sec^2(x)\dif x$\\
利用分部积分公式, 可得到以下结论:\\
$\begin{array}{c c}
u=\sec^4(x) & v=\tan(x)\\
\dfrac{\dif u}{\dif x}=4\sec^4(x)\tan(x) & \dfrac{\dif v}{\dif x}=\sec^2(x)
\end{array}$\\[1ex]
\begin{equation}
\int\sec^4(x)\sec^2(x)\dif x=\sec^4(x)\tan(x)-4\int\sec^4(x)\tan^2(x)\dif x\label{integral:sec_01}
\end{equation}
\begin{eqnarray}
\int\tan^2(x)\sec^4(x) & = & \int(\sec^2(x)-1)\sec^4(x)\dif x\nonumber\\
& = & \int\sec^6(x)\dif x-\int\sec^4(x)\dif x\label{integral:sec_02}
\end{eqnarray}
将\eqref{integral:sec_02}代入\eqref{integral:sec_01}, 得:\\
\begin{equation}
\displaystyle\int\sec^6(x)\dif x=\frac{1}{5}\sec^4(x)\tan(x)+\frac{4}{5}\int\sec^4(x)\dif x\label{integral:sec_03}
\end{equation}
$\displaystyle\int\sec^4(x)\dif x=\int\sec^2(x)\sec^2(x)\dif x$\\
利用分部积分公式, 得到如下结论:\\
$\begin{array}{c c}
u=\sec^2(x) & v=\tan(x)\\
\dfrac{\dif u}{\dif x}=2\sec^2(x)\tan(x) & \dfrac{\dif v}{\dif x}=\sec^2(x)
\end{array}$\\[1ex]
$\displaystyle\int\sec^4(x)\dif x=\sec^2(x)\tan(x)-2\int\tan^2(x)\sec^2(x)\dif x$\\
设$t=\tan(x)$, 则$\dif t=\sec^2(x)\dif x$, 得:\\
$\displaystyle\int\tan^2(x)\sec^2(x)\dif x=\int t^2\dif t=\dfrac{1}{3}t^2+C=\dfrac{1}{3}\tan^3(x)+C$\\[1ex]
\begin{equation}
\displaystyle\int\sec^4(x)\dif x=\sec^2(x)\tan(x)-\dfrac{2}{3}\tan^3(x)+C\label{integral:sec_04}
\end{equation}
将\eqref{integral:sec_04}代入\eqref{integral:sec_03}, 得:\\
$\displaystyle\int\sec^6(x)\dif x=\frac{1}{5}\sec^4(x)\tan(x)+\frac{4}{5}\sec^2(x)\tan(x)-\frac{8}{15}\tan^3(x)+C$\\[4ex]

3.关于三角换元法的积分\\
(1)类型I($\sqrt{a^2-x^2}$)\\
例.\\
$\displaystyle\int\frac{x^2}{\sqrt{(9-x^2)^3}}\dif x$\\
解题思路:\\
将$x$转化为三角函数$\sin(\theta)$的积分\\
推导过程:\\
设$x=3\sin(\theta)$且$\theta\in[-\frac{\pi}{2},\frac{\pi}{2}]$, 则$\dif x=3\cos(\theta)\dif\theta$, 得:\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\frac{x^2}{\sqrt{(9-x^2)^3}}\dif x & =\int\frac{9\sin^2(\theta)}{(3\cos(\theta))^3}\times 3\cos(\theta)\dif\theta\\
& =\int\tan^2(\theta)\dif\theta\\
& =\int(\sec^2(\theta)-1)\dif\theta\\
& =\tan(\theta)-\theta+C
\end{array}$\\
$\because\sin(\theta)=\dfrac{x}{3}$\\
$\therefore\cos(\theta)=\sqrt{1-\sin^2(\theta)}=\dfrac{\sqrt{9-x^2}}{3}$\\
$\phantom{\therefore}\tan(\theta)=\dfrac{x}{\sqrt{9-x^2}}$\\
$\displaystyle\therefore\int\frac{x^2}{\sqrt{(9-x^2)^3}}\dif x=\frac{x}{\sqrt{9-x^2}}-\sin^{-1}+C$\\[2ex]

(2)类型II($\sqrt{x^2+a^2}$)\\
例.\\
$\displaystyle\int(x^+15)^{-\frac{5}{2}}\dif x$\\
解题思路:\\
将$x$转化为三角函数$tan(\theta)$的积分\\
推导过程:\\
设$x=\sqrt{15}\tan(\theta)$且$\theta\in(-\frac{\pi}{2},\frac{\pi}{2})$, 则$\dif x=\sqrt{15}\sec^2(\theta)\dif\theta$, 得:\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int(x^2+15)^{-\frac{5}{2}}\dif x & =\int(15\tan^2(\theta)+15)^{-\frac{5}{2}}\times\sqrt{15}\sec^2(\theta)\dif\theta\\
& =\int(15\sec^2(\theta))^{-\frac{5}{2}}\sqrt{15}\sec^2(\theta)\dif\theta\\
& =\frac{1}{15^2}\int\cos^3(\theta)\dif\theta
\end{array}$\\[1ex]
设$t=\sin(\theta)$, 则$\dif t=\cos(\theta)\dif\theta$, 得:\\[1ex]
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int(x^2++15)^{-\frac{5}{2}}\dif x & =\frac{1}{15^2}\int(1-t^2)\dif t\\[1ex]
& =\frac{1}{15^2}\int 1\dif t-\frac{1}{15^2}\int t^2\dif t\\[1ex]
& =\frac{1}{15^2}t-\frac{1}{15^2\times 3}t^3+C\\[1ex]
& =\frac{1}{225}\sin(\theta)-\frac{1}{675}\sin^3(\theta)+C
\end{array}$\\
$\because\tan(\theta)=\dfrac{x}{\sqrt{15}}$\\
$\therefore\sec(\theta)=\sqrt{\tan^2(\theta)+1}=\dfrac{\sqrt{x^2+15}}{\sqrt{15}}$\\
$\phantom{\therefore}\sin(\theta)=\sqrt{1-\cos^2(\theta)}=\sqrt{1-\dfrac{15}{x^2+15}}=\dfrac{x}{\sqrt{x^2+15}}$\\
$\displaystyle\therefore\int(x^2+15)^{-\frac{5}{2}}\dif x=\frac{1}{225}\frac{x}{\sqrt{x^2+15}}-\frac{1}{675}\frac{x^3}{\sqrt{(x^2+15)^3}}+C$\\[2ex]

(3)类型III($\sqrt{x^2-a^2}$)\\
例.\\
$\displaystyle\int\frac{1}{x^3\sqrt{x^2-4}}\dif x$\\
解题思路:\\
将$x$转化为三角函数$\sec(\theta)$的积分\\
推导过程:\\
设$x=2\sec(\theta)$且$\theta\in[0,\frac{\pi}{2})\cup(\frac{\pi}{2},\pi]$, 则$\dif x=2\sec(\theta)\tan(\theta)\dif\theta$, 得:\\
$\displaystyle\int\frac{1}{x^3\sqrt{x^2-4}}\dif x=\int\frac{\sec(\theta)\tan(\theta)}{8\sec^3(\theta)\sqrt{\tan^2(\theta)}}\dif\theta$\\[1ex]
$\because$当$\theta\in[0,\frac{\pi}{2})$时, $\sqrt{\tan^2(\theta)}=\tan(\theta)$\\
\phantom{$\because$}当$\theta\in(\frac{\pi}{2},\pi]$时, $\sqrt{\tan^2(\theta)}=-\tan(\theta)$\\
$\therefore$根据$\theta$的不同取值区间, 区分为两种不同情况.\\
1)$\theta\in[0,\frac{\pi}{2})$时\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\frac{1}{x^3\sqrt{x^2-4}}\dif x & =\frac{1}{8}\int\frac{1}{\sec^2(\theta)}\dif\theta\\[1ex]
& =\frac{1}{8}\int\cos^2(\theta)\dif\theta\\[1ex]
& =\frac{1}{16}\int(1+\cos(2\theta))\dif\theta\\[1ex]
& =\frac{1}{16}\int 1\dif\theta+\frac{1}{16}\int\cos(2\theta)\dif\theta\\[1ex]
& =\frac{1}{16}\theta+\frac{1}{32}\sin(2\theta)+C
\end{array}$\\
$\because\sec(\theta)=\dfrac{x}{2}$\\
$\therefore\sin(\theta)=\sqrt{1-\cos^2(\theta)}=\dfrac{\sqrt{x^2-4}}{x}$\\
$\because\sin(2\theta)=2\sin(\theta)\cos(\theta)$\\
$\therefore\sin(2\theta)=\dfrac{4\sqrt{x^2-4}}{x^2}$\\
$\displaystyle\therefore\int\frac{1}{x^3\sqrt{x^2-4}}dif x=\frac{1}{16}\sec^{-1}(\frac{x}{2})+\frac{1}{8}\frac{\sqrt{x^2-4}}{x^2}+C$\\[1ex]
2)$\theta\in(\frac{\pi}{2},\pi]$时\\
$\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\int\frac{1}{x^3\sqrt{x^2-4}}\dif x & =-\frac{1}{8}\int\frac{1}{\sec^2(\theta)}\dif\theta\\[1ex]
& =-\frac{1}{8}\int\cos^2(\theta)\dif\theta\\[1ex]
& =-\frac{1}{16}\int(1+\cos(2\theta))\dif\theta\\[1ex]
& =-\frac{1}{16}\int 1\dif\theta-\frac{1}{16}\int\cos(2\theta)\dif\theta\\[1ex]
& =-\frac{1}{16}\theta-\frac{1}{32}\sin(2\theta)+C
\end{array}$\\[1ex]
$\because$在区间$(\dfrac{\pi}{2},\pi]$中, $\sec(\theta)=\dfrac{x}{2}\leqslant -1$\\[1ex]
$\therefore x\leqslant -2$\\
$\phantom{\therefore}\sin(\theta)=\sqrt{1-\cos^2(\theta)}=-\dfrac{\sqrt{x^2-4}}{x}$\\
$\because\sin(2\theta)=2\sin(\theta)\cos(\theta)$\\
$\therefore\sin(2\theta)=-\dfrac{4\sqrt{x^2-4}}{x^2}$\\
$\displaystyle\therefore\int\frac{1}{x^3\sqrt{x^2-4}}\dif x=-\frac{1}{16}\sec^{-1}(\frac{x}{2})+\frac{1}{8}\frac{\sqrt{x^2-4}}{x^2}+C$
