\chapter{正交性和最小二乘法}
\section{内积、长度和正交性}
如果$\bm{u}$和$\bm{v}$是$\mathbb{R}^n$中的向量，则可以将$\bm{u}$和$\bm{v}$作为$n\times 1$矩阵. 转置矩阵$\bm{u}^T$是$1\times n$矩阵，且矩阵乘积$\bm{u}^T\bm{v}$是一个$1\times 1$矩阵，我们将其记为一个不加括号的实数（标量）. 数$\bm{u}^T\bm{v}$称为$\bm{u}$和$\bm{v}$的\textbf{内积}，通常记作$\bm{u}\cdot\bm{v}$，也称为\textbf{点积}\\[2ex]

\begin{TheoremOne}
设$\bm{v}$,$\bm{u}$和$\bm{w}$是$\mathbb{R}^n$中的向量,$c$是一个数，那么\\
a.\ $\bm{u\cdot v=v\cdot u}$\\
b.\ $\bm{(u+v)\cdot w=u\cdot w+v\cdot w}$\\
c.\ $(c\bm{u})\cdot v=c(\bm{u\cdot v})=\bm{u}\cdot(c\bm{v})$\\
d.\ $\bm{u\cdot u}\geqslant 0$,并且$\bm{u\cdot u}=0$成立的充分必要条件是$\bm{u=0}$
\end{TheoremOne}\vspace{4ex}

\begin{definition}
向量$\bm{v}$的\textbf{长度}（或\textbf{范数}）是非负数$||\bm{v}||$,定义为
\[||\bm{v}||=\sqrt{\bm{v}\cdot \bm{v}}=\sqrt{v_1^2+v_2^2+\cdots+v_n^2}\text{\ 且\ }||\bm{v}||^2=\bm{v}\cdot \bm{v}\]
\end{definition}\vspace{4ex}

长度为1的向量称为\textbf{单位向量}. 如果把一个非零向量除以其自身的长度，即乘$\dfrac{1}{||\bm{v}||}$，就可以得到一个单位向量，即$\bm{u}=\dfrac{\bm{v}}{||\bm{v}||}$\\[1ex]

把向量$\bm{v}$化成单位向量$\bm{u}$的过程，称为向量$\bm{v}$的\textbf{单位化}\\[2ex]

\begin{definition}
如果$\bm{u\cdot v}=0$，则$\mathbb{R}^n$中的两个向量$\bm{u}$和$\bm{v}$是（相互）\textbf{正交的}
\end{definition}\vspace{4ex}

\begin{TheoremTwo}[毕达哥拉斯（勾股）定理]
两个向量$\bm{u}$和$\bm{v}$正交的充分必要条件是$||\bm{u+v}||^2=||\bm{u}||^2+||\bm{v}||^2$
\end{TheoremTwo}\vspace{4ex}

如果向量$\bm{z}$与$\mathbb{R}^n$的子空间W中的任意向量都正交，则称$\bm{z}$\textbf{正交于W}\\[1ex]

与子空间W正交的向量$\bm{z}$的全体组成的集合称为W的\textbf{正交补}，记作$W^\bot$\\[2ex]

{\par\centering
\framebox{\begin{minipage}{\textwidth}
1.向量$\bm{x}$属于$W^\bot$的充分必要条件是向量$\bm{x}$与生成空间W的任一向量都正交\\
2.$W^\bot$是$\mathbb{R}^n$的一个子空间
\end{minipage}}
\par}\vspace{4ex}

\begin{TheoremOne}
假设A是$m\times n$矩阵，那么A的行空间的正交补是A的零空间，且A的列空间的正交补是$A^T$的零空间:
\[(\Row A)^\bot=\Nul A\text{\ 且\ }(\Col A)^\bot=\Nul A^T\]
\end{TheoremOne}\vspace{4ex}

\section{正交集}
$\mathbb{R}^n$中的向量集合$\{\bm{u}_1,\cdots,\bm{u}_p\}$称为\textbf{正交集}，如果集合中的任意两个不同向量都正交，即当$i\neq j$时，$\bm{u_i\cdot u_j}=0$\\[2ex]

\begin{TheoremOne}
如果$S=\{\bm{u}_1,\cdots,\bm{u}_p\}$是由$\mathbb{R}^n$中非零向量构成的正交集，那么$S$是线性无关集，因此构成$S$所生成的子空间的一组基
\end{TheoremOne}\vspace{4ex}

\begin{definition}
$\mathbb{R}^n$中子空间W的一个\textbf{正交基}是W的一个基，也是正交集
\end{definition}\vspace{4ex}

\begin{TheoremOne}
假设$\{\bm{u}_1,\cdots,\bm{u}_p\}$是$\mathbb{R}^n$中子空间W的正交基，对W中的每个向量$\bm{y}$，线性组合$\bm{y}=c_1\bm{u}_1+\cdots+c_p\bm{u}_p$中的权可以由$c_j=\dfrac{\bm{y\cdot u_j}}{\bm{u_j\cdot u_j}}$（$j=1,\cdots,p$）计算
\end{TheoremOne}\vspace{4ex}

对$\mathbb{R}^n$中给出的非零向量$\bm{u}$，考虑$\mathbb{R}^n$中一个向量$\bm{y}$分解为两个向量之和的问题，一个向量是向量$\bm{u}$的倍数，另一个向量与$\bm{u}$正交. 我们期望写成
\begin{equation}
\bm{y}=\hat{\bm{y}}+\bm{z}\label{eq:08}
\end{equation}
其中$\hat{\bm{y}}=\alpha\bm{u}$，$\alpha$是一个数，$\bm{z}$是一个垂直于$\bm{u}$的向量. 对给定数$\alpha$，记$\bm{z}=\bm{y}-\alpha\bm{u}$，则方程\eqref{eq:08}可以满足. 那么$\bm{y}-\hat{\bm{y}}$和$\bm{u}$正交的充分必要条件是
\[(\bm{y}-\alpha\bm{u})\cdot\bm{u}=\bm{y\cdot u}-(\alpha\bm{u})\cdot\bm{u}=\bm{y\cdot u}-\alpha(\bm{u\cdot u})=0\]
也就是满足方程\eqref{eq:08}且$\bm{z}$与$\bm{u}$正交的充分必要条件是$\alpha=\dfrac{\bm{y\cdot u}}{\bm{u\cdot u}}$和$\hat{\bm{y}}=\proj_L\bm{y}=\dfrac{\bm{y\cdot u}}{\bm{u\cdot u}}\cdot\bm{u}$. 向量$\hat{\bm{y}}$称为\textbf{$\bm{y}$在$\bm{u}$上的正交投影}，向量$\bm{z}$称为\textbf{$\bm{y}$与$\bm{u}$正交的分量}\\[2ex]

如果集合$\{\bm{u}_1,\cdots,\bm{u}_p\}$是由单位向量构成的正交集，那么它是一个\textbf{单位正交集}\\[1ex]

如果W是一个由单位正交集合生成的子空间，那么$\{\bm{u}_1,\cdots,\bm{u}_p\}$是W的\textbf{单位正交基}\\[2ex]

\begin{TheoremOne}
一个$m\times n$矩阵$U$具有单位正交列向量的充分必要条件是$U^TU=I$
\end{TheoremOne}\vspace{4ex}

\begin{TheoremOne}
假设$U$是一个具有单位正交列的$m\times n$矩阵，且$\bm{x}$和$\bm{y}$是$\mathbb{R}^n$中的向量，那么\\
a.\ $||U\bm{x}||=||\bm{x}||$\\
b.\ $(U\bm{x})\cdot(U\bm{y})=\bm{x\cdot y}$\\
c.\ $(U\bm{x})\cdot(U\bm{y})=0$的充分必要条件是$\bm{x}\cdot\bm{y}=0$
\end{TheoremOne}\vspace{4ex}

\section{正交投影}
对给定向量$\bm{y}$和$\mathbb{R}^n$中子空间W，存在属于W的向量$\hat{\bm{y}}$满足:\\
(1)\ W中有唯一向量$\hat{\bm{y}}$，使得$\bm{y}-\hat{\bm{y}}$与W正交\\
(2)\ $\hat{\bm{y}}$是W中唯一最接近$\bm{y}$的向量\\[2ex]

\begin{TheoremTwo}[正交分解定理]
若W是$\mathbb{R}^n$的一个子空间，那么$\mathbb{R}^n$中每一个向量$\bm{y}$可以唯一表示为
\[\bm{y}=\hat{\bm{y}}+\bm{z}\]
其中$\hat{\bm{y}}$属于W而$\bm{z}$属于$W^\bot$. 实际上，如果$\{\bm{u}_1,\cdots,\bm{u}_p\}$是W的任意正交基，那么
\[\hat{\bm{y}}=\frac{\bm{y\cdot u_1}}{\bm{u_1\cdot u_1}}\bm{u}_1+\cdots+\frac{\bm{y\cdot u_p}}{\bm{u_p\cdot u_p}}\bm{u}_p\]
且$\bm{z}=\bm{y}-\hat{\bm{y}}$
\end{TheoremTwo}\vspace{4ex}

\begin{TheoremTwo}[最佳逼近定理]
假设W是$\mathbb{R}^n$的一个子空间，$\bm{y}$是$\mathbb{R}^n$中的任意向量，$\hat{\bm{y}}$是$\bm{y}$在W上的正交投影，那么$\hat{\bm{y}}$是W中最接近$\bm{y}$的点，也就是
\[||\bm{y}-\hat{\bm{y}}||<||\bm{y}-\bm{v}||\]
对所有属于W又异于$\hat{\bm{y}}$的$\bm{v}$成立
\end{TheoremTwo}\vspace{4ex}

\begin{TheoremOne}
如果$\{\bm{u}_1,\cdots,\bm{u}_p\}$是$\mathbb{R}^n$中子空间W的单位正交基，那么
\[\proj_W\bm{y}=(\bm{y}\cdot\bm{u}_1)\bm{u}_1+(\bm{y}\cdot\bm{u}_2)\bm{u}_2+\cdots+(\bm{y}\cdot\bm{u}_p)\bm{u}_p\]
如果$U=[\bm{u}_1\quad\bm{u}_2\quad\cdots\quad\bm{u}_p]$，则
\[\proj_W\bm{y}=UU^T\bm{y},\text{\ 对所有}\bm{y}\in\mathbb{R}^n\text{成立}\]
\end{TheoremOne}\vspace{4ex}

\section{格拉姆-施密特方法}
\begin{TheoremTwo}[格拉姆-施密特方法]
对$\mathbb{R}^n$的子空间W的一个基$\{\bm{x}_1,\cdots,\bm{x}_p\}$，定义
\[\begin{array}{>{\displaystyle}r >{\displaystyle}l}
\bm{v}_1 & =\bm{x}_1\\[1ex]
\bm{v}_2 & =\bm{x}_2-\frac{\bm{x}_2\cdot\bm{v}_1}{\bm{v}_1\cdot\bm{v}_1}\bm{v}_1\\[2ex]
\bm{v}_3 & =\bm{x}_3-\frac{\bm{x}_3\cdot\bm{v}_2}{\bm{v}_2\cdot\bm{v}_2}\bm{v}_2-\frac{\bm{x}_3\cdot\bm{v}_1}{\bm{v}_1\cdot\bm{v}_1}\bm{v}_1\\[1ex]
\vdots &\\[1ex]
\bm{v}_p & =\bm{x}_p-\frac{\bm{x}_p\cdot\bm{v}_{p-1}}{\bm{v}_{p-1}\cdot\bm{v}_{p-1}}\bm{v}_{p-1}-\cdots-\frac{\bm{x}_p\cdot\bm{v}_2}{\bm{v}_2\cdot\bm{v}_2}\bm{v}_2-\frac{\bm{x}_p\cdot\bm{v}_1}{\bm{v}_1\cdot\bm{v}_1}\bm{v}_1
\end{array}\]
那么$\{\bm{v}_1,\cdots,\bm{v}_p\}$是W的一个正交基. 此外，
\[\Span\{\bm{v}_1,\cdots,\bm{v}_k\}=\Span\{\bm{x}_1,\cdots,\bm{x}_k\},\text{\ 其中}1\leqslant k\leqslant p\]
\end{TheoremTwo}\vspace{4ex}

\begin{TheoremTwo}[QR分解]
如果$m\times n$矩阵A的列线性无关，那么A可以分解为A=QR，其中Q是一个$m\times n$矩阵，其列形成$\Col A$的一个标准正交基，R是一个$n\times n$上三角可逆矩阵且在对角线上的元素为正数
\end{TheoremTwo}\vspace{4ex}

\section{最小二乘问题}
当方程组的解不存在但又需要求解时，最好的方法是寻求$\bm{x}$，使得$A\bm{x}$尽可能接近$\bm{b}$\\[2ex]

\begin{definition}
如果$m\times n$矩阵A和向量$\bm{b}$属于$\mathbb{R}^m$，则$A\bm{x}=\bm{b}$的\textbf{最小二乘解}是$\mathbb{R}^n$中的$\hat{\bm{x}}$，使得
\[||\bm{b}-A\hat{\bm{x}}||\leqslant||\bm{b}-A\bm{x}||\]
对所有$\bm{x}\in\mathbb{R}^n$成立
\end{definition}\vspace{4ex}

对给定的A和$\bm{b}$，应用最佳逼近定理于子空间$\Col A$. 取
\[\hat{\bm{b}}=\proj_{\Col A}\bm{b}\]
由于$\hat{\bm{b}}$属于A的列空间，故方程$A\bm{x}=\hat{\bm{b}}$是相容的且存在一个属于$\mathbb{R}^n$的$\hat{\bm{x}}$使得
\begin{equation}
A\hat{\bm{x}}=\hat{\bm{b}}\label{chap-six-sec-five:01}
\end{equation}
由于$\hat{\bm{b}}$是$\Col A$中最接近$\bm{b}$的点，因此一个向量$\hat{\bm{x}}$是$A\bm{x}=\bm{b}$的一个最小二乘解的充分必要条件是$\hat{\bm{x}}$满足\eqref{chap-six-sec-five:01}.这个属于$\mathbb{R}^n$的$\hat{\bm{x}}$是一系列由A的列构造的$\hat{\bm{b}}$的权\\[2ex]

若$\hat{\bm{x}}$满足$A\hat{\bm{x}}=\hat{\bm{b}}$，则由正交分解定理，投影$\hat{\bm{b}}$具有性质$\bm{b}-\hat{\bm{b}}$与$\Col A$正交，即$\bm{b}-A\hat{\bm{x}}$正交于A的每一列. 如果$\bm{a}_j$是A的任意列，那么$\bm{a}_j\cdot(\bm{b}-A\hat{\bm{x}})=0$. 由于每一个$\bm{a}_j^T$是$A^T$的行，因此
\[A^T(\bm{b}-A\hat{\bm{x}})=\bm{0}\]
故有
\[A^T\bm{b}-A^TA\hat{\bm{x}}=\bm{0}\]
此计算表明$A\bm{x}=\bm{b}$的每个最小二乘解满足方程
\begin{equation}
A^TA\bm{x}=A^T\bm{b}\label{chap-six-sec-five:02}
\end{equation}
矩阵方程\eqref{chap-six-sec-five:02}表示的线性方程组常称为$A\bm{x}=\bm{b}$的\textbf{法方程}，\eqref{chap-six-sec-five:02}的解通常用$\hat{\bm{x}}$表示\\[2ex]

\begin{TheoremOne}
方程$A\bm{x}=\bm{b}$的最小二乘解集和法方程$A^TA\bm{x}=A^T\bm{b}$的非空解集一致
\end{TheoremOne}\vspace{4ex}

\begin{TheoremOne}
设A是$m\times n$矩阵. 下面的条件是逻辑等价的:\\
a)\ 对于$\mathbb{R}^m$中的每个$\bm{b}$,方程$A\bm{x}=\bm{b}$有唯一最小二乘解\\
b)\ A的列是线性无关的\\
c)\ 矩阵$A^TA$是可逆的\\
当这些条件成立时,最小二乘解$\hat{\bm{x}}$有下面的表示:
\[\hat{\bm{x}}=(A^TA)^{-1}A^T\bm{b}\]
\end{TheoremOne}\vspace{4ex}

\begin{TheoremOne}
给定一个$m\times n$矩阵A,它具有线性无关的列，取$A=QR$是A类似定理12的$QR$分解,那么对每一个属于$\mathbb{R}^m$的$\bm{b}$,方程$A\bm{x}=\bm{b}$有唯一的最小二乘解,其解为
\[\hat{\bm{x}}=R^{-1}Q^T\bm{b}\]
\end{TheoremOne}\vspace{4ex}

\section{线性模型中的应用}
为了更容易应用所讨论的实际问题，将$A\bm{x}=\bm{b}$写成$X\bm{\beta}=\bm{y}$，且称$X$为\textbf{设计矩阵}，$\bm{\beta}$为\textbf{参数向量}，$\bm{y}$为\textbf{观测向量}\\[2ex]

变量$x$和$y$之间最简单的关系是线性方程$y=\beta_0+\beta_1x$. 对应每一个数据点$(x_j,y_j)$，有一个在直线上的点$(x_j,\beta_0+\beta_1x_j)$具有同样的$x$坐标. 我们称$y_j$为$y$的\textbf{观测值}，而$\beta_0+\beta_1x_j$位$y$的\textbf{预测值}. 观测$y$值和预测$y$值之间的差称为\textbf{余差}\\[2ex]

\textbf{最小二乘直线}$y=\beta_0+\beta_1x$是余差平方之和最小的，这条直线也被称为$\bm{y}$对$\bm{x}$的\textbf{回归直线}.直线的系数$\beta_0$,$\beta_1$被称为（线性）\textbf{回归系数}\\[2ex]

计算$X\bm{\beta}=\bm{y}$的最小二乘问题等价于找出$\bm{\beta}$\\[2ex]

在计算最小二乘直线之前，常见的联系是计算原来$x$值的平均$\bar{x}$，并形成一个新变量$x^*=x-\bar{x}$.新的$x$数据被称为\textbf{平均偏差形式}\\[2ex]

在一些应用中，必须将数据点拟合为非直线形式. 引入\textbf{余差向量$\bm{\varepsilon}$}，定义为$\bm{\varepsilon}=\bm{y}-X\bm{\beta}$，并且记住
\[\bm{y}=X\bm{\beta}+\bm{\varepsilon}\]
任何具有这种形式的方程称为\textbf{线性模型}. 一旦$X$和$\bm{y}$被确定，使$\bm{\varepsilon}$长度达到最小化相当于找出$X\bm{\beta}=\bm{y}$的最小二乘解. 在每种情形下，最小二乘解$\hat{\bm{\beta}}$是下面法方程的解:
\[X^TX\bm{\beta}=X^T\bm{y}\]\\[2ex]

\section{内积空间}
\begin{definition}
向量空间V上的内积是一个函数，对每一对属于V的向量$\bm{u}$和$\bm{v}$，存在一个实数$\langle\bm{u},\bm{v}\rangle$满足下面公理，其中$\bm{u}$,$\bm{v}$,$\bm{w}$属于V，$c$为所有数:\\
1.\ $\langle\bm{u},\bm{v}\rangle=\langle\bm{v},\bm{u}\rangle$\\
2.\ $\langle\bm{u}+\bm{v},\bm{w}\rangle=\langle\bm{u},\bm{w}\rangle+\langle\bm{v},\bm{w}\rangle$\\
3.\ $\langle c\bm{u},\bm{v}\rangle=c\langle\bm{u},\bm{v}\rangle$\\
4.\ $\langle\bm{u},\bm{u}\rangle\geqslant 0\text{且}\langle\bm{u},\bm{u}\rangle=0\text{的充分必要条件是}\bm{u}=0$\\
一个赋予上面内积的向量空间称为\textbf{内积空间}
\end{definition}\vspace{4ex}

设V是一个内积空间，其内积记作$\langle\bm{u},\bm{v}\rangle$. 像$\mathbb{R}^n$中一样，我们定义一个向量$\bm{v}$的\textbf{长度}或\textbf{范数}是数
\[||\bm{v}||=\sqrt{\langle\bm{v},\bm{v}\rangle}\]
即$||\bm{v}||=\langle\bm{v},\bm{v}\rangle$\\[2ex]

一个单位向量是长度为1的向量，向量$\bm{u}$和$\bm{v}$之间的距离是$||\bm{u}-\bm{v}||$\\[1ex]

向量$\bm{u}$和向量$\bm{v}$正交，如果$\langle\bm{u},\bm{v}\rangle=0$成立\\[2ex]

\begin{TheoremTwo}[柯西-施瓦茨不等式]
对V中任意向量$\bm{u}$和$\bm{v}$,有
\[|\langle\bm{u},\bm{v}\rangle|\leqslant||\bm{u}||\ ||\bm{b}||\]
\end{TheoremTwo}\vspace{4ex}

\begin{TheoremTwo}[三角不等式]
对属于V的所有向量$\bm{u}$,$\bm{v}$,有
\[||\bm{u}+\bm{v}||=||\bm{u}||+||\bm{v}||\]
\end{TheoremTwo}
