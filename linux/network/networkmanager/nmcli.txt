nmcli - 控制网络的指令行工具. NetworkManager的指令行客户端

语法
nmcli [option] <action>

参数释义
-a, --ask
    用于交互式目标, 提示需要使用的参数

-c, --colors {yes | no | auto}
    输出是否采用彩色模式
    默认为auto

--complete-args
    提供可能补充的action列表

-e, --escape {yes | no}
    是否在tabular模式中跳脱':'和'\'字符, 跳脱字符为'\'
    默认为yes

-f, --fields {field1, field2... | all | common}
    显示指定字段. 列表如下:
        field1, field2... - 显示指定字段
        all - 显示所有字段
        common - 显示常用字段. 未提供选项时, 默认该值
	
-g, --get-values{field1, field2... | all | common}
    显示指定字段, 类似于-f, 但不显示字段名称

-h, --help
    帮助信息

-m, --mode {tabular | multiline}
    将输出在tabular和multiline之间切换. 两种模式介绍如下:
        tabular - 一行为一条记录, 每列为一条属性. 大多数指令默认使用该格式
        multiline - 每条记录为多行, 每行由属性名称和对应值构成.
        如下指令默认使用该格式:
            nmcli connection show <id>
            nmcli device show

-p, --pretty
    使用pretty输出格式(每一列的值对齐, 并显示header)

-s, --show-secrets
    显示密码相关字段

-t, --terse
    简化输出
	
-v, --version
    版本信息

-w, --wait <seconds>
    等待指令完成的时间




action说明
general command
nmcli general {status | hostname | permissions | logging}


status	
    显示总体网络状态. 默认action
    结果字段解释:
        STATE -- NetworkManager的状态
        CONNECTIVITY -- STATE字段对应的连接状态
        WIFI-HW -- 代表硬件(hardware)层面的wifi是否开启
        WIFI -- 代表软件层面的wifi是否开启(手动)


hostname [<hostname>]
    查看或设置主机名称


permissions
    各种网络功能的权限位是否启动


logging [level <level>] [domains <domain>...]
    查看或设置log等级和域



networking control command
nmcli networking [on | off | connectivity]


on | off
    从NetworkManger软件层面启动/关闭所有网络


connectivity
    查询NetworkManager软件层面的网络连接状态. 结果列表如下:
        none - 没有连接任何网络
        portal - 无法建立完整网络连接
        limited - 已连接到网络, 但无法访问Internet
        full - 已连接网络并且可以访问internet
        unknown - 无法获取网络连接状态



radio transmission control command
nmcli radio {all | wifi | wwan}


wifi [on | off]
    显示或启动/关闭软件层面的wifi


wwan [on | off]
    显示或启动/关闭移动蜂窝网络(如2G/3G/4G)接口


all [on | off]
    显示或启动/关闭所有上述两种无线网络接口



activity monitor command
nmcli monitor
    监测网络状态



connection management command
nmcli connection {show | up | down | modify | add | edit | clone | delete |
monitor | reload | load | import | export}


show [--active] [id | uuid | path | apath] <id>
    显示内存中或磁盘中的已配置的连接. 默认action
    active只显示当前活跃网络
    id等用于显示指定连接的详细信息. 列表如下:
        id - 连接的名称
        uuid - 连接的UUID
        path - D-Bus静态配置(deactive)连接路径,格式为/org/freedesktop/NetworkManager/Settings/<num>或<num>
        apath - D-Bus活跃配置(active)连接路径,格式为/org/freedesktop/NetworkManager/ActiveConnection/<num>或<num>


up [id | uuid | path] <id> [ifname <ifname>] [ap <ssid>] [passwd-file <file>]
    激活指定的连接


down [id | uuid | path | apath] <id>
    停用指定的连接
    但后续设备可执行自动激活



device management command
nmcli device {status | show | set | connect | reapply | modify | disconnect |
delete | monitor | wifi | lldp}


status
    显示设备接口状态
    默认action


show [<ifname>]
    显示接口的详细信息


set <ifname> [autoconnect {yes | no}] [managed {yes | no}]
    设置接口的属性


connect <ifname>
    连接到指定接口, 自动选择合适的网络


reapply <ifname>
    更新active连接的配置


disconnect <ifname>
    断开接口连接并阻止自动连接到网络


delete <ifname>
    删除接口
    只能删除bonds/bridges/teams等接口


monitor [<ifname>]
    监视接口


wifi [list [--rescan auto | no | yes] [ifname <ifname>] [bssid <bssid>]]
    显示可获得的wifi列表, 从缓存读取
    --rescan代表是否重新扫描AP. 参数如下: 
        auto - 每30s更新缓存. 不指定--rescan参数时的默认值
        no - 不更新缓存
        yes - 强制更新缓存
    通过ifname指定本地无线接口
    通过bssid(mac地址)指定access point


wifi connect {<ssid> | <bssid>} [password <passwd>] [wep-key-type {key | phrase}] [ifname
<ifname>] [bssid <bssid>] [name <name>] [private {yes | no}] [hidden {yes |
no}]
    通过热点名称(ssid)或AP mac地址(bssid)连接到wifi, 支持WEP/WPA类型wifi, 通过DHCP获取IP
    当该连接已连接过, 与以下指令同效果: nmcli connection up id <name>
    可选参数列表:
        password - wifi密码(WEP或WPA类型)
        ifname - 指定用于连接wifi的接口
        bssid - 限定连接ap的mac地址
        name - 指定连接的别名
        private - 当设置为yes, 只有创建连接的用户可以查看. 默认为no
        hidden - 是否连接到隐藏的wifi


wifi hotsport [ifname <ifname>] [con-name <name>] [ssid <ssid>] [band {a |
bg}] [channel <channel>] [password <passwd>]
    创建一个热点. 参数如下:
        ifname - 创建热点的设备
        con-name - 创建热点的配置文件名称
        ssid - 热点名称
        password - 热点密码
    可使用如下指令关闭热点:
        nmcli connection down [id | uuid]
        nmcli device disconnect <ifname>


lldp [list [ifname <ifname>]]
	显示邻居设备信息, 通过lldp协议



示例1 - 查看NetworkManager状态, 以及接口硬件/软件层面的状态
nmcli general

示例2 - 硬件接口的详情状态
nmcli device status

示例3 - 软件层面启动wifi
nmcli radio wifi on

示例4 - 实时可获得的wifi
nmcli device wifi list --rescan yes

示例5 - 连接到指定wifi
nmcli device wifi connect <ssid> password <passwd>



引用:
[1] man 1 nmcli
[2] man 7 nmcli-examples
[3] http://www.freedesktop.org/wiki/Software/polkit


最后编辑于: 2023-07-12

